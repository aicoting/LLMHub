ğŸ“š** å¤§æ¨¡å‹æ¡†æ¶ç³»åˆ—æ–‡ç« **

[å¤§æ¨¡å‹å·¥ç¨‹æ¡†æ¶ç”Ÿæ€å…¨è§ˆ](https://zhuanlan.zhihu.com/p/1946500640349094644)

[æ·±å…¥ LangChainï¼šå¤§æ¨¡å‹å·¥ç¨‹æ¡†æ¶æ¶æ„å…¨è§£æ](https://zhuanlan.zhihu.com/p/1946599445497095365)

[æ‰‹æŠŠæ‰‹å¸¦ä½ ä½¿ç”¨LangChainæ¡†æ¶ä»0å®ç°RAG](https://zhuanlan.zhihu.com/p/1946857016162252076)

[æ·±å…¥ vLLMï¼šé«˜æ€§èƒ½å¤§æ¨¡å‹æ¨ç†æ¡†æ¶è§£æ](https://zhuanlan.zhihu.com/p/1947248904983811905)

****

åœ¨å¤§æ¨¡å‹å·¥ç¨‹ä¸­ï¼Œ**çŸ¥è¯†ç®¡ç†ä¸æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAG, Retrieval-Augmented Generationï¼‰** æ˜¯æå‡æ¨¡å‹å‡†ç¡®æ€§å’Œå®ç”¨æ€§çš„å…³é”®ã€‚é€šè¿‡å°†æ–‡æ¡£ã€å‘é‡ç´¢å¼•ã€é•¿æœŸè®°å¿†å’Œå¤šæ•°æ®æºç»“åˆï¼Œå¤§æ¨¡å‹èƒ½å¤Ÿåœ¨å¤æ‚ä»»åŠ¡ä¸­å®ç°çŸ¥è¯†å¢å¼ºç”Ÿæˆã€‚

å‰é¢æˆ‘å·²ç»ä»‹ç»äº†RAGçš„æ¦‚å¿µï¼Œå·¥ä½œæµç¨‹ï¼Œå¹¶ä¸”ç”¨LangChainæ¡†æ¶å®ç°äº†ä¸€ä¸ªå°å°çš„demoï¼Œé™¤äº†LangChainæ¡†æ¶ï¼Œè¿˜æœ‰å¾ˆå¤šä¼˜ç§€çš„RAGæ¡†æ¶ã€‚

æœ¬ç¯‡æ–‡ç« å°±è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ LlamaIndexå’ŒHaystack è¿™ä¸¤ä¸ªæ¡†æ¶ï¼Œæˆ‘ç®€å•çš„ä»‹ç»ä¸€ä¸‹æ¶æ„è®¾è®¡ï¼Œä»¥åŠå¤šæ¡†æ¶é›†æˆå’ŒçŸ¥è¯†åº“åŠ¨æ€ç®¡ç†å®è·µï¼ŒåŒæ—¶æä¾›ç¤ºä¾‹ä»£ç å¸®åŠ©ä½ å¿«é€Ÿç†è§£å¹¶ä¸Šæ‰‹åšè‡ªå·±çš„å°demoã€‚

<font style="color:rgb(25, 27, 31);">æ‰€æœ‰ç›¸å…³æºç ç¤ºä¾‹ã€æµç¨‹å›¾ã€æ¨¡å‹é…ç½®ä¸çŸ¥è¯†åº“æ„å»ºæŠ€å·§ï¼Œæˆ‘ä¹Ÿå°†æŒç»­æ›´æ–°åœ¨Githubï¼š</font>[**<font style="color:rgb(25, 27, 31);">LLMHub</font>**](https://github.com/algcoting/LLMHub)<font style="color:rgb(25, 27, 31);">ï¼Œæ¬¢è¿å…³æ³¨æ”¶è—ï¼</font>

å¸Œæœ›å¤§å®¶å¸¦ç€ä¸‹é¢çš„é—®é¢˜æ¥å­¦ä¹ ï¼Œæˆ‘ä¼šåœ¨æ–‡æœ«ç»™å‡ºç­”æ¡ˆï¼š

1. **LlamaIndex å’Œ Haystack çš„æ ¸å¿ƒæ¶æ„è®¾è®¡å’Œä½¿ç”¨æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ**
2. **å¤šæ¡†æ¶ï¼ˆLangChain + LlamaIndex + vLLMï¼‰é›†æˆå®è·µå¦‚ä½•å®ç°ï¼Ÿ**
3. **çŸ¥è¯†åº“åŠ¨æ€æ›´æ–°ã€é•¿æœŸè®°å¿†è®¾è®¡å’Œå¤šæ•°æ®æºæ•´åˆæœ‰å“ªäº›æœ€ä½³å®è·µï¼Ÿ**

---

## 1. LlamaIndex æ¶æ„è§£æ
![](https://cdn.nlark.com/yuque/0/2025/png/28454971/1755140223422-246d2ae6-681b-4f45-ba83-69d91f87cb8a.png)

LlamaIndex æ˜¯ä¸€ä¸ª**é¢å‘å¤§æ¨¡å‹çš„å‘é‡ç´¢å¼•ä¸æ–‡æ¡£ç®¡ç†æ¡†æ¶**ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š

+ æ–‡æ¡£å¯¼å…¥å’Œé¢„å¤„ç†
+ æ–‡æ¡£å‘é‡åŒ–ä¸ç´¢å¼•æ„å»º
+ æŸ¥è¯¢æ£€ç´¢ä¸ç»“æœèšåˆ

#### ç¤ºä¾‹ä»£ç ï¼šæ„å»ºå‘é‡ç´¢å¼•
```python
from llama_index import SimpleDirectoryReader, GPTVectorStoreIndex
# LlamaIndex å°†æ–‡æ¡£å‘é‡åŒ–å­˜å‚¨ï¼Œå¯ç”¨äºé«˜æ•ˆçŸ¥è¯†æ£€ç´¢ï¼Œæ”¯æ’‘ RAG æµç¨‹ã€‚
# è¯»å–æœ¬åœ°æ–‡æ¡£
documents = SimpleDirectoryReader('docs/').load_data()

# æ„å»ºå‘é‡ç´¢å¼•
index = GPTVectorStoreIndex.from_documents(documents)

# æŸ¥è¯¢
query = "Explain the capital of France."
response = index.query(query)
print(response)
```

---

## 2. Haystack æ¶æ„è®¾è®¡
å’ŒLlamaIndexç±»ä¼¼ï¼ŒHaystack æ˜¯ä¸€ä¸ªå®Œæ•´çš„ **æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æ¡†æ¶**ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼š

+ å¤šç§æ–‡æ¡£å­˜å‚¨å’Œç´¢å¼•ï¼ˆFAISSã€Elasticsearchã€Milvus ç­‰ï¼‰
+ å¤šæ¨¡å‹ç»„åˆï¼ˆæ£€ç´¢å™¨ + ç”Ÿæˆå™¨ï¼‰
+ å¤šè½®å¯¹è¯ä¸çŸ¥è¯†è¿½è¸ª

#### ç¤ºä¾‹ä»£ç ï¼šæ„å»ºæ£€ç´¢å™¨ + ç”Ÿæˆå™¨ç®¡é“
```python
from haystack.nodes import FARMReader, BM25Retriever
from haystack.pipelines import ExtractiveQAPipeline
from haystack.document_stores import FAISSDocumentStore
# Haystack æ”¯æŒå¤šæ¨¡å‹ç»„åˆå’Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œæ–¹ä¾¿å¿«é€Ÿæ­å»º RAG ç³»ç»Ÿã€‚
# åˆ›å»ºæ–‡æ¡£å­˜å‚¨
document_store = FAISSDocumentStore(faiss_index_factory_str="Flat")

# æ·»åŠ æ–‡æ¡£
document_store.write_documents([{"content": "Paris is the capital of France.", "meta": {}}])

# åˆå§‹åŒ–æ£€ç´¢å™¨å’Œç”Ÿæˆå™¨
retriever = BM25Retriever(document_store=document_store)
reader = FARMReader(model_name_or_path="deepset/roberta-base-squad2")

# æ„å»º RAG ç®¡é“
pipeline = ExtractiveQAPipeline(reader, retriever)

# æ‰§è¡ŒæŸ¥è¯¢
result = pipeline.run(query="Where is Paris?", params={"Retriever": {"top_k": 1}})
print(result['answers'][0].answer)
```

---

## 3. å¤šæ¡†æ¶é›†æˆæ¡ˆä¾‹ï¼šLangChain + LlamaIndex + vLLM
æˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†LangChainå¹¶æ‰‹æŠŠæ‰‹å¸¦ä½ ä»¬å®ç°äº†ä¸€ä¸ªdemoï¼Œå¦‚æœå†æ¬¡å°† LangChainã€LlamaIndex å’Œ vLLM é›†æˆï¼Œå¯ä»¥å®ç°æ¯”æˆ‘ä»¬ä¸Šæ¬¡æ›´é«˜æ•ˆçš„ä»£ç ï¼Œä»–ä»¬å„è‡ªè´Ÿè´£ï¼š

+ LangChain è´Ÿè´£ä»»åŠ¡ç¼–æ’ã€Agent è°ƒåº¦
+ LlamaIndex æä¾›å‘é‡ç´¢å¼•ä¸çŸ¥è¯†æ£€ç´¢
+ vLLM æä¾›é«˜ååé‡æ¨ç†èƒ½åŠ›

#### ç¤ºä¾‹ä»£ç ï¼šç®€å•é›†æˆ
```python
from langchain import LLMChain, PromptTemplate
from langchain.llms import VLLM
from llama_index import GPTVectorStoreIndex, SimpleDirectoryReader
# ç»“åˆå¤šæ¡†æ¶ï¼Œå¯ä»¥å®ç°é«˜æ€§èƒ½ã€çŸ¥è¯†å¢å¼ºçš„ç”Ÿæˆåº”ç”¨ã€‚
# è¯»å–æ–‡æ¡£å¹¶åˆ›å»ºç´¢å¼•
documents = SimpleDirectoryReader("docs/").load_data()
index = GPTVectorStoreIndex.from_documents(documents)

# å®šä¹‰ LangChain Prompt
template = PromptTemplate(input_variables=["query", "context"], template="Answer using context: {context}\nQuestion: {query}")
llm = VLLM(model="huggingface/gpt-j-6B")
chain = LLMChain(llm=llm, prompt=template)

# æŸ¥è¯¢ä¸ç”Ÿæˆ
query = "What is the capital of France?"
context = index.query(query).response
result = chain.run({"query": query, "context": context})
print(result)
```

---

## 4. çŸ¥è¯†åº“åŠ¨æ€æ›´æ–°ä¸é•¿æœŸè®°å¿†è®¾è®¡
åŒæ—¶LLamaIndexè¿˜æœ‰ä¸€ä¸ªéå¸¸ç‰›çš„åŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥å®ç°çŸ¥è¯†åº“çš„åŠ¨æ€æ›´æ–°å’Œå¯¹è¯çš„é•¿æœŸè®°å¿†ï¼Œè¿™å¯¹äºä¸å›ºå®šçš„çŸ¥è¯†åº“å’Œéœ€è¦é•¿æœŸå¯¹è¯çš„ç”¨æˆ·å¯ä»¥è¯´æ˜¯ä¸€é“ç…§äº®ä»–ä»¬çš„å…‰ï¼Œæ²¡é”™ï¼ŒçœŸç¥é™ä¸´ï¼

LlamaIndexæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š

+ **åŠ¨æ€æ›´æ–°**ï¼šå®šæœŸæˆ–å®æ—¶æ·»åŠ æ–°æ–‡æ¡£åˆ°ç´¢å¼•
+ **é•¿æœŸè®°å¿†**ï¼šç»“åˆå‘é‡æ•°æ®åº“å’Œç¼“å­˜ç­–ç•¥ï¼Œå®ç°å¤šè½®ä»»åŠ¡è®°å¿†
+ **ç­–ç•¥è®¾è®¡**ï¼šæ ¹æ®ä»»åŠ¡ç±»å‹å’Œç”¨æˆ·åå¥½ï¼ŒåŠ¨æ€è°ƒæ•´æ£€ç´¢ç»“æœå’Œç”Ÿæˆé€»è¾‘

#### ç¤ºä¾‹ä»£ç ï¼šåŠ¨æ€æ·»åŠ æ–‡æ¡£åˆ° LlamaIndex
```python
from llama_index import GPTVectorStoreIndex, Document
# åŠ¨æ€æ›´æ–°ä¿è¯çŸ¥è¯†åº“åŠæ—¶ç”Ÿæ•ˆï¼Œæ”¯æ’‘é•¿æœŸå¯¹è¯å’Œå¤šè½®ä»»åŠ¡ã€‚
new_doc = Document(text="Berlin is the capital of Germany.")
index.insert(new_doc)

# æŸ¥è¯¢æ–°æ–‡æ¡£
response = index.query("What is the capital of Germany?")
print(response)
```

---

## 5. å¤šæ•°æ®æºæ•´åˆä¸è·¨æ¨¡æ€æ£€ç´¢
åŒæ—¶ï¼ŒLlamaIndexå®ç°çš„RAG ç³»ç»Ÿå¯æ”¯æŒæ–‡æœ¬ã€è¡¨æ ¼ã€PDFã€å›¾ç‰‡ç­‰å¤šæ•°æ®æºï¼Œå¹¶ç»Ÿä¸€å‘é‡åŒ–å¤„ç†ï¼Œå®ç°è·¨æ¨¡æ€æ£€ç´¢ï¼Œèƒ½å¤Ÿæ»¡è¶³ç»å¤§éƒ¨åˆ†åœºæ™¯çš„ä½¿ç”¨éœ€æ±‚ã€‚

#### ç¤ºä¾‹ä»£ç ï¼šæ–‡æœ¬ + PDF é›†æˆï¼ˆä¼ªç¤ºä¾‹ï¼‰
```python
from llama_index.readers import SimpleDirectoryReader
from llama_index import GPTVectorStoreIndex
# å¤šæ•°æ®æºæ•´åˆä¿è¯æ¨¡å‹èƒ½å¤Ÿè·å–æ›´å…¨é¢çš„çŸ¥è¯†ï¼Œå®ç°è·¨æ¨¡æ€å¢å¼ºç”Ÿæˆã€‚
# è¯»å–æ–‡æœ¬å’Œ PDF
text_docs = SimpleDirectoryReader("text_docs/").load_data()
pdf_docs = SimpleDirectoryReader("pdf_docs/").load_data()

# åˆå¹¶å¹¶åˆ›å»ºç´¢å¼•
all_docs = text_docs + pdf_docs
index = GPTVectorStoreIndex.from_documents(all_docs)

# æŸ¥è¯¢
response = index.query("Explain AI concepts in the PDFs and texts.")
print(response)
```

---

æœ€åï¼Œæˆ‘ä»¬å›ç­”æ–‡ç« å¼€å¤´çš„é—®é¢˜

1. **LlamaIndex å’Œ Haystack çš„æ ¸å¿ƒæ¶æ„å’Œä½¿ç”¨æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ**  
LlamaIndex æä¾›å‘é‡ç´¢å¼•å’Œæ–‡æ¡£ç®¡ç†ï¼›Haystack æä¾›æ£€ç´¢ + ç”Ÿæˆçš„ RAG ç®¡é“ï¼Œæ”¯æŒå¤šæ¨¡å‹ç»„åˆå’Œå¤šè½®å¯¹è¯ã€‚
2. **å¤šæ¡†æ¶é›†æˆå®è·µå¦‚ä½•å®ç°ï¼Ÿ**  
LangChain è´Ÿè´£ä»»åŠ¡ç¼–æ’ï¼ŒLlamaIndex æä¾›çŸ¥è¯†æ£€ç´¢ï¼ŒvLLM æä¾›é«˜ååé‡æ¨ç†ï¼Œå®ç°é«˜æ€§èƒ½çŸ¥è¯†å¢å¼ºç”Ÿæˆã€‚
3. **çŸ¥è¯†åº“åŠ¨æ€æ›´æ–°ã€é•¿æœŸè®°å¿†è®¾è®¡å’Œå¤šæ•°æ®æºæ•´åˆæœ‰å“ªäº›æœ€ä½³å®è·µï¼Ÿ**  
é€šè¿‡åŠ¨æ€æ’å…¥æ–‡æ¡£ã€å‘é‡åŒ–å­˜å‚¨ã€å¤šæ•°æ®æºæ•´åˆå’Œç¼“å­˜ç­–ç•¥ï¼Œå®ç°å¤šè½®ä»»åŠ¡è®°å¿†å’Œè·¨æ¨¡æ€æ£€ç´¢ï¼Œä¿è¯ç³»ç»Ÿçµæ´»ã€é«˜æ•ˆå’Œå¯æ‰©å±•ã€‚

---

å…³äºæ·±åº¦å­¦ä¹ å’Œå¤§æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†å’Œå‰æ²¿æŠ€æœ¯æ›´æ–°ï¼Œè¯·å…³æ³¨å…¬ä¼—å· **coting**ï¼

ä»¥ä¸Šå†…å®¹å‚è€ƒ LlamaIndexã€Haystack å’Œ LangChain å®˜æ–¹æ–‡æ¡£åŠç¤¾åŒºèµ„æ–™ï¼Œå¦‚æœ‰ä¾µæƒè¯·è”ç³»åˆ é™¤ã€‚



